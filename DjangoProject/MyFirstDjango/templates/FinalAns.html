{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中山附醫藥品數量辨識系統</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/FinalAns.css' %}">
    <link rel="icon" href="{% static 'image/drugIcon.png' %}" type="image/x-icon">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
</head>
<body style="margin:0">
    <header class="header">
        <div class="header-logo">
            <img src="{% static 'image/cshlogo.png' %}" alt="Logo" style="width: 30%; max-width: 100px; height: auto; margin-right: 3%;">
            <p class="fancy-text header-text">中山附醫藥品辨識系統</p>
        </div>
        <nav>
            <ul class="nav-list">
                <li><a href="/index/">首頁</a></li>
                <li><a href="/instructions/">操作說明</a></li>
                <li><a href="#">關於我們</a></li>
            </ul>
        </nav>        
    </header>
    <div class="content">
        <div class="camera_area d-flex justify-content-center align-items-center">
            <img src="data:image/png;base64,{{img}}" alt="Image" class="img-fluid">
        </div>        
        <!-- <div class="camera_area">
            <img src="data:image/png;base64,{{img}}" alt="Image" class="result-image">
        </div> -->
        <div class="result-count">
            <p>
                {% for class_name, count in class_counts.items %}
                    {% if class_name == 'p1' %}
                        {{ 'vial' }}: {{ count }} 個{% if not forloop.last %}, {% endif %}
                    {% else %}
                        {{ 'Ampoule' }}: {{ count }} 個{% if not forloop.last %}, {% endif %}
                    {% endif %}
                {% endfor %}
            </p>
        </div>
    </div>
    <footer class="footer">
        <p>Copyright &copy; 2023 Information Department of Chung Shan Medical University Hospital. All rights reserved.</p>
    </footer>
</body>
</html>
<script>
    $("#back_btn").click(function(){
        $('#back').submit();
    })
    function shoot() {
        var video = $("#camera")[0];
        var canvas = capture(video);
        $("#result").empty();
        $("#result").append(canvas); //呈現圖像(拍照結果)
        $('canvas').css("width","100%");
        $('canvas').css("aspect-ratio"," 1 / 1");
    }
    function capture(video) {
        var canvas = document.createElement('canvas'); //建立canvas js DOM元素
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        var ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0);
        return canvas;
    }
</script>
